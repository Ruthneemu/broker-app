<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrokerConnect - Premium Item Listings</title>
    <!-- Google Fonts: Inter for modern typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* Global & Reset Styles */
        :root {
            --primary-blue: #3A7DE8; /* Vibrant Blue */
            --secondary-dark: #2c3e50; /* Dark Charcoal */
            --light-gray: #f8f9fa;
            --medium-gray: #e9ecef;
            --dark-gray-text: #343a40;
            --success-green: #28a745;
            --error-red: #dc3545;
            --box-shadow-light: 0 4px 12px rgba(0, 0, 0, 0.08);
            --box-shadow-medium: 0 8px 20px rgba(0, 0, 0, 0.12);
            --border-radius-lg: 15px;
            --transition-speed: 0.3s;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--light-gray);
            color: var(--dark-gray-text);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden; /* Prevent horizontal scroll due to animations */
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 1.5rem;
            width: 100%;
        }

        /* --- Header --- */
        header {
            background: linear-gradient(to right, #1a237e, #3f51b5); /* Deep Indigo to Lighter Blue */
            color: white;
            padding: 1rem 0;
            box-shadow: var(--box-shadow-medium);
            border-bottom-left-radius: var(--border-radius-lg);
            border-bottom-right-radius: var(--border-radius-lg);
        }

        header .nav-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            padding: 0 1.5rem;
        }

        header h1 {
            font-size: 2.8rem;
            font-weight: 900;
            letter-spacing: -0.8px;
            margin: 0;
            cursor: pointer;
            transition: transform var(--transition-speed) ease;
        }

        header h1:hover {
            transform: translateY(-3px);
            color: #b3e5fc; /* Lighter blue on hover */
        }

        header nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 1.2rem;
            margin-top: 1rem;
        }

        @media (min-width: 768px) {
            header nav ul {
                margin-top: 0;
            }
        }

        header nav button {
            color: white;
            background: none;
            border: none;
            padding: 0.7rem 1.2rem;
            border-radius: 10px;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            font-weight: 600;
            font-size: 1.05rem;
            cursor: pointer;
            outline: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        header nav button:hover {
            background-color: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        header nav button.add-item-btn {
            background-color: #fff;
            color: var(--primary-blue);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.25);
            padding: 0.7rem 1.4rem;
            font-weight: 700;
            border: 2px solid transparent;
        }

        header nav button.add-item-btn:hover {
            background-color: #e0f2f7; /* Lighter hover for add button */
            color: #1a237e;
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.35);
        }

        /* --- Main Content Area --- */
        main {
            flex-grow: 1;
            padding: 2.5rem 0;
        }

        /* Page Content Wrapper */
        .page-content-wrapper {
            background-color: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-medium);
            padding: 2.5rem;
            margin-top: 2rem;
            animation: fadeIn 0.7s ease-out forwards;
            min-height: 500px; /* Ensure content area has a min height */
            display: flex;
            flex-direction: column;
        }

        .page-content-wrapper.loading {
            min-height: 300px; /* Smaller height for loading */
            justify-content: center;
            align-items: center;
        }

        /* --- Home Page --- */
        .hero-section {
            text-align: center;
            padding: 4rem 1.5rem;
            background: linear-gradient(to bottom right, #e0f7fa, #bbdefb); /* Soft gradient background */
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-medium);
            margin-bottom: 2.5rem;
        }

        .hero-section h2 {
            font-size: 4.5rem;
            font-weight: 900;
            color: var(--secondary-dark);
            margin-bottom: 1.5rem;
            line-height: 1.1;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .hero-section h2 span {
            color: var(--primary-blue);
        }

        .hero-section p {
            font-size: 1.5rem;
            color: #555;
            max-width: 900px;
            margin: 0 auto 3.5rem auto;
            line-height: 1.7;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
        }

        .category-card {
            background-color: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-light);
            overflow: hidden;
            transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .category-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .category-card img {
            width: 100%;
            height: 240px;
            object-fit: cover;
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
            transition: transform 0.4s ease;
        }

        .category-card:hover img {
            transform: scale(1.08);
        }

        .category-card-content {
            padding: 1.8rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .category-card-content h3 {
            font-size: 2.3rem;
            font-weight: 800;
            color: var(--secondary-dark);
            margin-bottom: 0.8rem;
        }

        .category-card-content p {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 1.5rem;
            flex-grow: 1;
            line-height: 1.6;
        }

        .category-card-content button {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 1rem 1.8rem;
            border-radius: 10px;
            font-size: 1.15rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: fit-content;
        }

        .category-card-content button:hover {
            background-color: #2a6ed8;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .category-card-content button svg {
            margin-left: 0.8rem;
            transition: transform 0.2s ease;
        }

        .category-card-content button:hover svg {
            transform: translateX(8px);
        }

        /* --- Item List Layout --- */
        .page-header {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping */
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            gap: 1rem; /* Spacing between header elements */
        }

        .page-header h2 {
            font-size: 3.2rem;
            font-weight: 800;
            color: var(--secondary-dark);
            text-transform: capitalize;
            margin: 0;
        }

        .back-button {
            background-color: var(--medium-gray);
            color: var(--dark-gray-text);
            border: none;
            padding: 0.8rem 1.6rem;
            border-radius: 10px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease;
            display: inline-flex;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .back-button:hover {
            background-color: #dbe2e6;
            transform: translateY(-2px);
        }

        .back-button svg {
            margin-right: 0.6rem;
        }

        .filter-search-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: center;
            width: 100%; /* Take full width */
        }

        .filter-search-controls select,
        .filter-search-controls input[type="text"] {
            flex-grow: 1; /* Allow them to grow */
            padding: 0.8rem 1.2rem;
            border: 1px solid #ced4da;
            border-radius: 10px;
            font-size: 1.05rem;
            color: #495057;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            max-width: 300px; /* Limit max width for inputs */
        }

        .filter-search-controls input[type="text"] {
            min-width: 200px;
        }

        .filter-search-controls select:focus,
        .filter-search-controls input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(58, 125, 232, 0.25);
        }


        .item-list-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .item-card {
            background-color: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-light);
            overflow: hidden;
            transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .item-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.18);
        }

        .item-card img {
            width: 100%;
            height: 280px;
            object-fit: cover;
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
        }

        .item-card-content {
            padding: 1.6rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .item-card-content h3 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--secondary-dark);
            margin-bottom: 0.6rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .item-card-content p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 0.8rem;
        }

        .item-card-content .price {
            font-size: 2.8rem;
            font-weight: 800;
            color: var(--primary-blue);
            margin-top: auto;
            margin-bottom: 1rem;
        }

        .item-card-content button {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 0.9rem 1.5rem;
            border-radius: 10px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease;
            width: 100%;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .item-card-content button:hover {
            background-color: #2a6ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        /* --- Item Detail Page --- */
        .item-detail-section {
            background-color: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-medium);
            padding: 2.5rem;
            margin-top: 2rem;
            animation: fadeIn 0.7s ease-out forwards;
            display: flex;
            flex-direction: column;
        }

        .item-detail-content {
            display: flex;
            flex-direction: column;
            gap: 2.5rem;
        }

        @media (min-width: 992px) {
            .item-detail-content {
                flex-direction: row;
            }
            .item-detail-content > div:first-child {
                flex: 2;
            }
            .item-detail-content > div:last-child {
                flex: 1;
            }
        }

        .item-detail-section img {
            width: 100%;
            height: 500px; /* Larger image for detail */
            object-fit: cover;
            border-radius: var(--border-radius-lg);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
            margin-bottom: 2rem;
        }

        .item-detail-section h2 {
            font-size: 3.8rem;
            font-weight: 800;
            color: var(--secondary-dark);
            margin-bottom: 1rem;
        }

        .item-detail-section .detail-price {
            font-size: 4.5rem;
            font-weight: 900;
            color: var(--primary-blue);
            margin-bottom: 2rem;
        }

        .item-detail-section .description {
            font-size: 1.3rem;
            color: #444;
            margin-bottom: 2.5rem;
            line-height: 1.8;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            background-color: #f0f4f8;
            padding: 2.5rem;
            border-radius: var(--border-radius-lg);
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        .features-grid h3 {
            grid-column: 1 / -1;
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--secondary-dark);
            margin-bottom: 1rem;
            text-align: left;
        }

        .features-grid p {
            font-size: 1.2rem;
            color: #495057;
        }

        .features-grid p strong {
            color: var(--secondary-dark);
            font-weight: 700;
        }

        .contact-box {
            background-color: #e6f7ff; /* Lighter blue background */
            border-left: 6px solid var(--primary-blue);
            padding: 2.5rem;
            border-radius: var(--border-radius-lg);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }

        .contact-box h3 {
            font-size: 2.4rem;
            font-weight: 700;
            color: var(--secondary-dark);
            margin-bottom: 1.5rem;
        }

        .contact-box p {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 1.2rem;
        }

        .contact-box p strong {
            display: block;
            font-weight: 600;
            margin-bottom: 0.6rem;
        }

        .contact-box a {
            color: var(--primary-blue);
            text-decoration: none;
            transition: color var(--transition-speed) ease;
        }

        .contact-box a:hover {
            text-decoration: underline;
            color: #2a6ed8;
        }

        .contact-box button {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-size: 1.15rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            width: 100%;
            margin-top: 2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
        }

        .contact-box button:hover {
            background-color: #2a6ed8;
            transform: translateY(-4px);
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.35);
        }

        /* --- Add Item Form --- */
        .add-item-form-section {
            background-color: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-medium);
            padding: 2.5rem;
            margin-top: 2rem;
            animation: fadeIn 0.7s ease-out forwards;
        }

        .add-item-form-section h2 {
            font-size: 3rem;
            font-weight: 800;
            color: var(--secondary-dark);
            margin-bottom: 2rem;
            text-align: center;
        }

        .form-group {
            margin-bottom: 1.8rem;
            position: relative; /* For labels and error messages */
        }

        .form-group label {
            display: block;
            font-size: 1.15rem;
            font-weight: 600;
            color: var(--dark-gray-text);
            margin-bottom: 0.7rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 1rem;
            border: 1px solid #ced4da;
            border-radius: 10px;
            font-size: 1.1rem;
            color: #495057;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(58, 125, 232, 0.25);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .form-section-separator {
            border-top: 1px solid var(--medium-gray);
            padding-top: 2rem;
            margin-top: 2rem;
        }

        .form-section-separator h3 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--secondary-dark);
            margin-bottom: 1.5rem;
        }

        .submit-button {
            width: 100%;
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 1.2rem 2rem;
            border-radius: 12px;
            font-size: 1.4rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            margin-top: 2.5rem;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .submit-button:hover {
            background-color: #2a6ed8;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
        }

        .error-message {
            color: var(--error-red);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: block;
        }

        .form-group.invalid input,
        .form-group.invalid textarea,
        .form-group.invalid select {
            border-color: var(--error-red);
        }


        /* --- Footer --- */
        footer {
            background-color: var(--secondary-dark);
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-top: auto;
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.15);
        }

        footer p {
            margin: 0.6rem 0;
            font-size: 0.95rem;
            color: #adb5bd;
        }

        /* --- Message Modal --- */
        .message-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .message-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .message-modal-content {
            background-color: white;
            padding: 2.5rem;
            border-radius: var(--border-radius-lg);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            text-align: center;
            max-width: 500px;
            width: 90%;
            transform: translateY(-50px) scale(0.9);
            opacity: 0;
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55), opacity 0.4s ease; /* Pop effect */
        }

        .message-modal-overlay.active .message-modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .message-modal-content h3 {
            font-size: 2.2rem;
            color: var(--secondary-dark);
            margin-bottom: 1.5rem;
        }

        .message-modal-content p {
            font-size: 1.25rem;
            color: #555;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .message-modal-content button {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 1rem 2.2rem;
            border-radius: 10px;
            font-size: 1.15rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .message-modal-content button:hover {
            background-color: #2a6ed8;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .message-modal-content.success {
            border-top: 8px solid var(--success-green);
        }

        .message-modal-content.error {
            border-top: 8px solid var(--error-red);
        }

        /* --- Loading Spinner --- */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .spinner {
            border: 8px solid #f3f3f3; /* Light grey */
            border-top: 8px solid var(--primary-blue); /* Blue */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- Utility Classes & Animations --- */
        .hidden {
            display: none !important;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive Adjustments */
        @media (max-width: 991px) {
            header .nav-container {
                flex-direction: column;
                text-align: center;
            }
            header nav ul {
                flex-direction: column;
                align-items: center;
                gap: 0.75rem;
                margin-top: 1.5rem;
            }
            header h1 {
                font-size: 2.2rem;
            }
            header nav button {
                padding: 0.6rem 1rem;
                font-size: 1rem;
            }
            .hero-section h2 {
                font-size: 3.5rem;
            }
            .hero-section p {
                font-size: 1.25rem;
            }
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                margin-bottom: 1.5rem;
            }
            .page-header h2 {
                font-size: 2.8rem;
                margin-bottom: 1rem;
            }
            .filter-search-controls {
                flex-direction: column;
                align-items: flex-start;
                width: 100%;
            }
            .filter-search-controls select,
            .filter-search-controls input[type="text"] {
                width: 100%;
                max-width: none; /* Allow full width */
            }
            .item-detail-section img {
                height: 350px;
            }
            .item-detail-section h2 {
                font-size: 3rem;
            }
            .item-detail-section .detail-price {
                font-size: 3.5rem;
            }
            .item-detail-section .description {
                font-size: 1.15rem;
            }
            .features-grid {
                grid-template-columns: 1fr;
            }
            .features-grid h3 {
                text-align: center;
            }
            .add-item-form-section h2 {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 576px) {
            .container {
                padding: 1rem;
            }
            header h1 {
                font-size: 1.9rem;
            }
            header nav ul {
                gap: 0.5rem;
            }
            header nav button {
                padding: 0.5rem 0.8rem;
                font-size: 0.9rem;
            }
            .hero-section h2 {
                font-size: 2.8rem;
            }
            .hero-section p {
                font-size: 1rem;
            }
            .category-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            .category-card-content h3 {
                font-size: 2rem;
            }
            .category-card-content p {
                font-size: 1rem;
            }
            .page-content-wrapper {
                padding: 1.5rem;
            }
            .page-header h2 {
                font-size: 2.2rem;
            }
            .back-button {
                padding: 0.6rem 1.2rem;
                font-size: 0.95rem;
            }
            .item-list-grid {
                grid-template-columns: 1fr;
            }
            .item-card img {
                height: 220px;
            }
            .item-card-content h3 {
                font-size: 1.7rem;
            }
            .item-card-content .price {
                font-size: 2.3rem;
            }
            .item-detail-section h2 {
                font-size: 2.2rem;
            }
            .item-detail-section .detail-price {
                font-size: 2.8rem;
            }
            .item-detail-section .description {
                font-size: 1rem;
            }
            .features-grid p {
                font-size: 1rem;
            }
            .contact-box {
                padding: 1.5rem;
            }
            .contact-box h3 {
                font-size: 2rem;
            }
            .contact-box p {
                font-size: 1rem;
            }
            .add-item-form-section h2 {
                font-size: 2.2rem;
            }
            .form-group label {
                font-size: 1rem;
            }
            .form-group input, .form-group textarea, .form-group select {
                padding: 0.8rem;
                font-size: 1rem;
            }
            .submit-button {
                padding: 1rem 1.5rem;
                font-size: 1.2rem;
            }
            .message-modal-content {
                padding: 1.5rem;
            }
            .message-modal-content h3 {
                font-size: 1.8rem;
            }
            .message-modal-content p {
                font-size: 1.05rem;
            }
            .message-modal-content button {
                padding: 0.7rem 1.5rem;
                font-size: 1rem;
            }
        }

        /* Custom Scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e0e0e0;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="nav-container">
            <h1 onclick="navigateTo('home')">BrokerConnect 🏠</h1>
            <nav>
                <ul>
                    <li><button onclick="navigateTo('home')">Home</button></li>
                    <li><button onclick="navigateTo('apartment')">Apartments</button></li>
                    <li><button onclick="navigateTo('car')">Cars</button></li>
                    <li><button onclick="navigateTo('land')">Land</button></li>
                    <li><button class="add-item-btn" onclick="navigateTo('addItem')">+ Add Item</button></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main>
        <!-- Dynamic content will be loaded here -->
        <div id="app-content" class="container"></div>
    </main>

    <!-- Footer Section -->
    <footer>
        <div class="container">
            <p>&copy; <span id="current-year"></span> BrokerConnect. All rights reserved.</p>
            <p>Your trusted partner in real estate and automotive brokering.</p>
        </div>
    </footer>

    <!-- Message Modal -->
    <div id="message-modal-overlay" class="message-modal-overlay">
        <div id="message-modal-content" class="message-modal-content">
            <h3 id="modal-title"></h3>
            <p id="modal-message"></p>
            <button onclick="hideMessageModal()">OK</button>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <script>
        // --- Data Management (Simulated Database with localStorage) ---
        // Retrieve items from localStorage or initialize with default data
        let items = JSON.parse(localStorage.getItem('brokerItems')) || [];

        // Save items to localStorage whenever changes occur
        const saveItems = () => {
            localStorage.setItem('brokerItems', JSON.stringify(items));
        };

        // Populate with initial items if localStorage is empty on first load
        if (items.length === 0) {
            items = [
                {
                    id: '_' + Math.random().toString(36).substr(2, 9),
                    type: 'apartment',
                    title: 'Luxury Downtown Apartment',
                    description: 'Experience unparalleled urban living in this spacious 3-bedroom apartment. Boasting panoramic city views, modern amenities, and sophisticated design, it is perfectly situated close to public transport, vibrant shopping districts, and fine dining. Enjoy exclusive access to a rooftop pool, state-of-the-art gym, and 24/7 concierge service.',
                    price: 550000,
                    imageUrl: 'https://placehold.co/800x600/3A7DE8/ffffff?text=Luxury+Apartment',
                    location: 'Metropolitan Heights, Downtown',
                    bedrooms: 3,
                    bathrooms: 2,
                    areaSqFt: 1850
                },
                {
                    id: '_' + Math.random().toString(36).substr(2, 9),
                    type: 'car',
                    title: '2023 Tesla Model 3 Long Range',
                    description: 'Drive into the future with this pristine 2023 Tesla Model 3. Featuring extended range capabilities, advanced autopilot system, and a minimalist premium interior. This electric vehicle offers blistering acceleration and fast charging, making long journeys effortless. Equipped with latest software updates and in excellent condition.',
                    price: 45000,
                    imageUrl: 'https://placehold.co/800x600/2ecc71/ffffff?text=Tesla+Model+3',
                    make: 'Tesla',
                    model: 'Model 3',
                    year: 2023,
                    mileage: 12500,
                    fuelType: 'Electric'
                },
                {
                    id: '_' + Math.random().toString(36).substr(2, 9),
                    type: 'land',
                    title: 'Prime Residential Plot - Lake View',
                    description: 'Discover the perfect location to build your dream home on this half-acre prime residential plot. Situated in a serene, developing community with breathtaking lake views, it offers tranquility without sacrificing accessibility. Close proximity to top-rated schools, modern hospitals, and recreational facilities. Utilities readily available.',
                    price: 120000,
                    imageUrl: 'https://placehold.co/800x600/e74c3c/ffffff?text=Residential+Plot',
                    location: 'Willow Creek Estates, Lakeside',
                    areaAcres: 0.75,
                    zoning: 'Residential'
                },
                {
                    id: '_' + Math.random().toString(36).substr(2, 9),
                    type: 'apartment',
                    title: 'Modern Loft Studio',
                    description: 'Chic and cozy loft studio, ideal for a single professional or student. Fully furnished with contemporary designs, smart home features, and abundant natural light. Located in a vibrant arts district with easy access to cafes, galleries, and public transport.',
                    price: 180000,
                    imageUrl: 'https://placehold.co/800x600/9b59b6/ffffff?text=Modern+Loft',
                    location: 'Artisan Quarter, City Center',
                    bedrooms: 1,
                    bathrooms: 1,
                    areaSqFt: 600
                },
                {
                    id: '_' + Math.random().toString(36).substr(2, 9),
                    type: 'car',
                    title: '2021 Toyota RAV4 AWD',
                    description: 'Reliable and versatile 2021 Toyota RAV4, perfect for family adventures. Features all-wheel drive, spacious interior, and excellent fuel efficiency. Equipped with advanced safety features and a responsive infotainment system. Well-maintained with complete service history.',
                    price: 32000,
                    imageUrl: 'https://placehold.co/800x600/f1c40f/ffffff?text=Toyota+RAV4',
                    make: 'Toyota',
                    model: 'RAV4',
                    year: 2021,
                    mileage: 28000,
                    fuelType: 'Petrol'
                },
                {
                    id: '_' + Math.random().toString(36).substr(2, 9),
                    type: 'land',
                    title: 'Expansive Commercial Development Site',
                    description: 'A significant 2-acre commercial plot with direct highway frontage, offering unparalleled visibility and accessibility. This site is zoned for commercial development, making it suitable for a retail complex, office park, or logistics center. High traffic area with growing commercial demand.',
                    price: 850000,
                    imageUrl: 'https://placehold.co/800x600/1abc9c/ffffff?text=Commercial+Land',
                    location: 'Industrial Gateway, Highway 101',
                    areaAcres: 2.0,
                    zoning: 'Commercial'
                },
            ];
            saveItems();
        }

        // Global state variables
        let currentPage = 'home'; // Current view: 'home', 'apartment', 'car', 'land', 'addItem', 'itemDetail'
        let selectedItemId = null; // ID of the item currently being viewed in detail

        // DOM elements
        const appContentDiv = document.getElementById('app-content');
        const messageModalOverlay = document.getElementById('message-modal-overlay');
        const messageModalContent = document.getElementById('message-modal-content');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const loadingOverlay = document.getElementById('loading-overlay');

        // --- Utility Functions ---
        /**
         * Generates a simple unique ID string.
         * @returns {string} A unique ID.
         */
        const generateUniqueId = () => '_' + Math.random().toString(36).substr(2, 9);

        /**
         * Simulates a network delay for loading content.
         * @param {number} ms - The delay in milliseconds.
         */
        const delay = (ms) => new Promise(res => setTimeout(res, ms));

        // --- Loading Overlay Functions ---
        /**
         * Displays the loading spinner.
         */
        function showLoading() {
            loadingOverlay.classList.add('active');
        }

        /**
         * Hides the loading spinner.
         */
        function hideLoading() {
            loadingOverlay.classList.remove('active');
        }

        // --- Message Modal Functions ---
        /**
         * Displays a custom message modal.
         * @param {string} title - The title of the message.
         * @param {string} message - The message content.
         * @param {string} type - 'success' or 'error' for styling.
         */
        function showMessageModal(title, message, type) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            messageModalContent.className = 'message-modal-content'; // Reset classes
            if (type) {
                messageModalContent.classList.add(type);
            }
            messageModalOverlay.classList.add('active');
        }

        /**
         * Hides the custom message modal.
         */
        function hideMessageModal() {
            messageModalOverlay.classList.remove('active');
            // Clear content and reset classes after animation for readiness
            setTimeout(() => {
                modalTitle.textContent = '';
                modalMessage.textContent = '';
                messageModalContent.className = 'message-modal-content';
            }, 400); // Match CSS transition duration
        }

        // --- Navigation Logic ---
        /**
         * Navigates to a specific page or view.
         * @param {string} page - The target page ('home', 'apartment', 'car', 'land', 'addItem', 'itemDetail').
         * @param {string} itemId - (Optional) The ID of the item if navigating to 'itemDetail'.
         */
        async function navigateTo(page, itemId = null) {
            showLoading(); // Show loading spinner
            await delay(300); // Simulate network delay

            currentPage = page;
            selectedItemId = itemId;
            renderPage();
            window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top on navigation

            hideLoading(); // Hide loading spinner
        }

        // --- Render Functions for Each Page/Component ---

        /**
         * Renders the Home Page content.
         */
        function renderHomePage() {
            appContentDiv.innerHTML = `
                <div class="hero-section">
                    <h2>Welcome to <span style="color: var(--primary-blue);">BrokerConnect</span></h2>
                    <p>Your ultimate marketplace for premium apartments, reliable cars, and valuable land. Discover your next great investment with ease, precision, and trust.</p>
                </div>
                <div class="category-grid">
                    <div class="category-card" onclick="navigateTo('apartment')">
                        <img src="https://placehold.co/600x400/3A7DE8/ffffff?text=Apartments" alt="Apartments">
                        <div class="category-card-content">
                            <h3>Apartments</h3>
                            <p>Find your dream home or a lucrative investment property, from cozy studios to luxury penthouses.</p>
                            <button>View Listings
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="category-card" onclick="navigateTo('car')">
                        <img src="https://placehold.co/600x400/2ecc71/ffffff?text=Cars" alt="Cars">
                        <div class="category-card-content">
                            <h3>Cars</h3>
                            <p>Explore a wide range of vehicles, from luxury sedans and powerful SUVs to efficient daily commuters.</p>
                            <button>View Listings
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="category-card" onclick="navigateTo('land')">
                        <img src="https://placehold.co/600x400/e74c3c/ffffff?text=Land" alt="Land">
                        <div class="category-card-content">
                            <h3>Land</h3>
                            <p>Secure prime plots for residential, commercial, or agricultural use. Invest in your future today.</p>
                            <button>View Listings
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `;
            appContentDiv.classList.add('page-content-wrapper'); // Apply common styling
        }

        /**
         * Renders the Item List Page for a specific category, including search and filter.
         * @param {string} category - The category of items to display ('apartment', 'car', 'land').
         */
        function renderItemList(category) {
            const currentSearchQuery = localStorage.getItem('searchQuery-' + category) || '';
            const currentFilterType = localStorage.getItem('filterType-' + category) || category; // Default to category

            const allItemsForCategory = items.filter(item => item.type === category);
            let displayedItems = allItemsForCategory;

            // Apply search filter
            if (currentSearchQuery) {
                const query = currentSearchQuery.toLowerCase();
                displayedItems = displayedItems.filter(item =>
                    item.title.toLowerCase().includes(query) ||
                    item.description.toLowerCase().includes(query) ||
                    (item.location && item.location.toLowerCase().includes(query)) ||
                    (item.make && item.make.toLowerCase().includes(query)) ||
                    (item.model && item.model.toLowerCase().includes(query))
                );
            }

            let itemsHtml = '';
            if (displayedItems.length === 0) {
                itemsHtml = `<p style="text-align: center; color: #666; font-size: 1.2rem; margin-top: 5rem;">No items found matching your criteria.</p>`;
            } else {
                itemsHtml = displayedItems.map(item => `
                    <div class="item-card" onclick="navigateTo('itemDetail', '${item.id}')">
                        <img src="${item.imageUrl || `https://placehold.co/600x400/CCCCCC/000000?text=${item.type}+Image`}" alt="${item.title}" onerror="this.onerror=null; this.src='https://placehold.co/600x400/CCCCCC/000000?text=Image+Not+Found';">
                        <div class="item-card-content">
                            <h3>${item.title}</h3>
                            <p>
                                ${item.type === 'apartment' ? `${item.bedrooms} Bed | ${item.bathrooms} Bath | ${item.areaSqFt} sq.ft` : ''}
                                ${item.type === 'car' ? `${item.year} ${item.make} | ${item.mileage.toLocaleString()} miles` : ''}
                                ${item.type === 'land' ? `${item.areaAcres} acres | ${item.location}` : ''}
                            </p>
                            <p class="price">$${item.price.toLocaleString()}</p>
                            <button>View Details</button>
                        </div>
                    </div>
                `).join('');
            }

            appContentDiv.innerHTML = `
                <div class="page-header">
                    <h2>${category} Listings</h2>
                    <button class="back-button" onclick="navigateTo('home')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Back to Home
                    </button>
                </div>
                <div class="filter-search-controls">
                    <input type="text" id="searchBar" placeholder="Search by title, description, location..." value="${currentSearchQuery}">
                    <select id="filterCategory" style="display:none;"> <!-- Hidden as we are already on a category page -->
                        <option value="${category}">${category.charAt(0).toUpperCase() + category.slice(1)}</option>
                    </select>
                </div>
                <div class="item-list-grid">
                    ${itemsHtml}
                </div>
            `;
            appContentDiv.classList.add('page-content-wrapper'); // Apply common styling

            // Attach listeners for search and filter (even if filter dropdown is hidden)
            document.getElementById('searchBar').addEventListener('input', (event) => {
                localStorage.setItem('searchQuery-' + category, event.target.value);
                renderItemList(category); // Re-render list with new search query
            });
            // document.getElementById('filterCategory').addEventListener('change', (event) => {
            //     localStorage.setItem('filterType-' + category, event.target.value);
            //     navigateTo(event.target.value); // Navigate to the selected category list
            // });
        }

        /**
         * Renders the Item Detail Page.
         * @param {string} itemId - The ID of the item to display.
         */
        function renderItemDetail(itemId) {
            const item = items.find(i => i.id === itemId);

            if (!item) {
                appContentDiv.innerHTML = `
                    <p style="text-align: center; font-size: 1.2rem; color: #666; margin-top: 5rem;">Item not found. Please go back to the list.</p>
                    <button class="back-button" onclick="navigateTo('home')" style="margin-top: 2rem; margin-left: auto; margin-right: auto;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Back to Home
                    </button>
                `;
                appContentDiv.classList.add('page-content-wrapper'); // Apply common styling
                return;
            }

            let itemDetailsHtml = '';
            if (item.type === 'apartment') {
                itemDetailsHtml = `
                    <p><strong>Location:</strong> ${item.location}</p>
                    <p><strong>Bedrooms:</strong> ${item.bedrooms}</p>
                    <p><strong>Bathrooms:</strong> ${item.bathrooms}</p>
                    <p><strong>Area:</strong> ${item.areaSqFt} sq.ft</p>
                `;
            } else if (item.type === 'car') {
                itemDetailsHtml = `
                    <p><strong>Make:</strong> ${item.make}</p>
                    <p><strong>Model:</strong> ${item.model}</p>
                    <p><strong>Year:</strong> ${item.year}</p>
                    <p><strong>Mileage:</strong> ${item.mileage.toLocaleString()} miles</p>
                    <p><strong>Fuel Type:</strong> ${item.fuelType}</p>
                `;
            } else if (item.type === 'land') {
                itemDetailsHtml = `
                    <p><strong>Location:</strong> ${item.location}</p>
                    <p><strong>Area:</strong> ${item.areaAcres} acres</p>
                    <p><strong>Zoning:</strong> ${item.zoning}</p>
                `;
            }

            appContentDiv.innerHTML = `
                <div class="item-detail-section">
                    <button class="back-button" onclick="navigateTo('${item.type}')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Back to List
                    </button>
                    <div class="item-detail-content">
                        <div>
                            <img src="${item.imageUrl || `https://placehold.co/800x600/CCCCCC/000000?text=Image+Not+Found`}" alt="${item.title}" onerror="this.onerror=null; this.src='https://placehold.co/800x600/CCCCCC/000000?text=Image+Not+Found';">
                            <h2>${item.title}</h2>
                            <p class="detail-price">$${item.price.toLocaleString()}</p>
                            <p class="description">${item.description}</p>
                            <div class="features-grid">
                                <h3>Key Features</h3>
                                ${itemDetailsHtml}
                            </div>
                        </div>
                        <div class="contact-box">
                            <h3>Contact Broker</h3>
                            <p>Interested in this item? Reach out to the broker for more details or to schedule a viewing.</p>
                            <p><strong>Email:</strong> <a href="mailto:broker@example.com">broker@example.com</a></p>
                            <p><strong>Phone:</strong> <a href="tel:+1234567890">+1 (234) 567-890</a></p>
                            <button>Send Inquiry</button>
                        </div>
                    </div>
                </div>
            `;
            appContentDiv.classList.remove('page-content-wrapper'); // Remove general wrapper as this section has its own styling
        }

        /**
         * Renders the Add Item Form page.
         */
        function renderAddItemForm() {
            appContentDiv.innerHTML = `
                <div class="add-item-form-section">
                    <button class="back-button" onclick="navigateTo('home')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Back
                    </button>
                    <h2>Add New Listing</h2>
                    <form id="addItemForm">
                        <div class="form-group">
                            <label for="itemType">Item Type</label>
                            <select id="itemType" name="itemType">
                                <option value="apartment">Apartment</option>
                                <option value="car">Car</option>
                                <option value="land">Land</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="title">Title</label>
                            <input type="text" id="title" name="title" placeholder="e.g., Spacious 3-bedroom apartment" required minlength="5">
                            <span class="error-message" id="title-error"></span>
                        </div>
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea id="description" name="description" rows="5" placeholder="Provide a detailed description of the item..." required minlength="20"></textarea>
                            <span class="error-message" id="description-error"></span>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="price">Price ($)</label>
                                <input type="number" id="price" name="price" placeholder="e.g., 550000" required min="1000">
                                <span class="error-message" id="price-error"></span>
                            </div>
                            <div class="form-group">
                                <label for="imageUrl">Image URL (Optional)</label>
                                <input type="url" id="imageUrl" name="imageUrl" placeholder="e.g., https://example.com/apartment.jpg">
                                <span class="error-message" id="imageUrl-error"></span>
                            </div>
                        </div>

                        <!-- Type-specific fields will be dynamically inserted here -->
                        <div id="typeSpecificFields"></div>

                        <button type="submit" class="submit-button">Add Item</button>
                    </form>
                </div>
            `;
            appContentDiv.classList.remove('page-content-wrapper'); // Remove general wrapper as this section has its own styling
            attachAddItemFormListeners();
        }

        /**
         * Attaches event listeners for the Add Item Form, including dynamic field rendering and validation.
         */
        function attachAddItemFormListeners() {
            const form = document.getElementById('addItemForm');
            const itemTypeSelect = document.getElementById('itemType');
            const typeSpecificFieldsDiv = document.getElementById('typeSpecificFields');

            /**
             * Helper function to show/hide validation errors.
             * @param {HTMLElement} inputElement - The input field.
             * @param {string} message - The error message to display.
             */
            function setValidationError(inputElement, message) {
                const errorSpan = document.getElementById(inputElement.id + '-error');
                if (errorSpan) {
                    errorSpan.textContent = message;
                    inputElement.closest('.form-group').classList.add('invalid');
                }
            }

            /**
             * Helper function to clear validation errors.
             * @param {HTMLElement} inputElement - The input field.
             */
            function clearValidationError(inputElement) {
                const errorSpan = document.getElementById(inputElement.id + '-error');
                if (errorSpan) {
                    errorSpan.textContent = '';
                    inputElement.closest('.form-group').classList.remove('invalid');
                }
            }

            /**
             * Validates a single input field.
             * @param {HTMLElement} inputElement - The input field to validate.
             * @returns {boolean} True if valid, false otherwise.
             */
            function validateField(inputElement) {
                clearValidationError(inputElement); // Always clear before re-validating

                if (inputElement.hasAttribute('required') && !inputElement.value.trim()) {
                    setValidationError(inputElement, 'This field is required.');
                    return false;
                }
                if (inputElement.type === 'number') {
                    if (isNaN(inputElement.value) || inputElement.value === '') {
                        setValidationError(inputElement, 'Please enter a valid number.');
                        return false;
                    }
                    if (inputElement.hasAttribute('min') && parseFloat(inputElement.value) < parseFloat(inputElement.min)) {
                        setValidationError(inputElement, `Value must be at least ${inputElement.min}.`);
                        return false;
                    }
                    if (inputElement.hasAttribute('max') && parseFloat(inputElement.value) > parseFloat(inputElement.max)) {
                        setValidationError(inputElement, `Value cannot exceed ${inputElement.max}.`);
                        return false;
                    }
                }
                if (inputElement.type === 'url' && inputElement.value.trim() !== '') {
                    try {
                        new URL(inputElement.value);
                    } catch (_) {
                        setValidationError(inputElement, 'Please enter a valid URL.');
                        return false;
                    }
                }
                if (inputElement.hasAttribute('minlength') && inputElement.value.length < parseInt(inputElement.minlength)) {
                    setValidationError(inputElement, `Minimum length is ${inputElement.minlength} characters.`);
                    return false;
                }
                return true;
            }

            /**
             * Renders fields specific to the selected item type.
             */
            function renderTypeSpecificFields() {
                const selectedType = itemTypeSelect.value;
                let fieldsHtml = '';

                if (selectedType === 'apartment') {
                    fieldsHtml = `
                        <div class="form-section-separator">
                            <h3>Apartment Details</h3>
                            <div class="form-group">
                                <label for="location">Location</label>
                                <input type="text" id="location" name="location" placeholder="e.g., Downtown City" required>
                                <span class="error-message" id="location-error"></span>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="bedrooms">Bedrooms</label>
                                    <input type="number" id="bedrooms" name="bedrooms" placeholder="e.g., 3" required min="1">
                                    <span class="error-message" id="bedrooms-error"></span>
                                </div>
                                <div class="form-group">
                                    <label for="bathrooms">Bathrooms</label>
                                    <input type="number" id="bathrooms" name="bathrooms" placeholder="e.g., 2" required min="1">
                                    <span class="error-message" id="bathrooms-error"></span>
                                </div>
                                <div class="form-group">
                                    <label for="areaSqFt">Area (sq.ft)</label>
                                    <input type="number" id="areaSqFt" name="areaSqFt" placeholder="e.g., 1500" required min="100">
                                    <span class="error-message" id="areaSqFt-error"></span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (selectedType === 'car') {
                    fieldsHtml = `
                        <div class="form-section-separator">
                            <h3>Car Details</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="make">Make</label>
                                    <input type="text" id="make" name="make" placeholder="e.g., Tesla" required>
                                    <span class="error-message" id="make-error"></span>
                                </div>
                                <div class="form-group">
                                    <label for="model">Model</label>
                                    <input type="text" id="model" name="model" placeholder="e.g., Model 3" required>
                                    <span class="error-message" id="model-error"></span>
                                </div>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="year">Year</label>
                                    <input type="number" id="year" name="year" placeholder="e.g., 2023" required min="1900" max="${new Date().getFullYear() + 1}">
                                    <span class="error-message" id="year-error"></span>
                                </div>
                                <div class="form-group">
                                    <label for="mileage">Mileage (miles)</label>
                                    <input type="number" id="mileage" name="mileage" placeholder="e.g., 12000" required min="0">
                                    <span class="error-message" id="mileage-error"></span>
                                </div>
                                <div class="form-group">
                                    <label for="fuelType">Fuel Type</label>
                                    <input type="text" id="fuelType" name="fuelType" placeholder="e.g., Electric, Petrol, Diesel" required>
                                    <span class="error-message" id="fuelType-error"></span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (selectedType === 'land') {
                    fieldsHtml = `
                        <div class="form-section-separator">
                            <h3>Land Details</h3>
                            <div class="form-group">
                                <label for="landLocation">Location</label>
                                <input type="text" id="landLocation" name="landLocation" placeholder="e.g., Greenwood Estates" required>
                                <span class="error-message" id="landLocation-error"></span>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="areaAcres">Area (acres)</label>
                                    <input type="number" id="areaAcres" name="areaAcres" placeholder="e.g., 0.5" step="0.01" required min="0.01">
                                    <span class="error-message" id="areaAcres-error"></span>
                                </div>
                                <div class="form-group">
                                    <label for="zoning">Zoning</label>
                                    <input type="text" id="zoning" name="zoning" placeholder="e.g., Residential, Commercial" required>
                                    <span class="error-message" id="zoning-error"></span>
                                </div>
                            </div>
                        </div>
                    `;
                }
                typeSpecificFieldsDiv.innerHTML = fieldsHtml;

                // Attach input event listeners for real-time validation feedback
                const inputs = form.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    input.addEventListener('input', () => validateField(input));
                });
            }

            // Initial render of type-specific fields when the form page loads
            renderTypeSpecificFields();

            // Listen for changes in item type selection to re-render dynamic fields
            itemTypeSelect.addEventListener('change', () => {
                renderTypeSpecificFields();
            });

            // Handle form submission
            form.addEventListener('submit', async (event) => {
                event.preventDefault(); // Prevent default form submission

                let formIsValid = true;
                const allFormInputs = form.querySelectorAll('input, textarea, select');
                allFormInputs.forEach(input => {
                    // Only validate visible, enabled fields.
                    if (input.offsetParent !== null && !input.disabled) {
                        if (!validateField(input)) {
                            formIsValid = false;
                        }
                    }
                });

                if (!formIsValid) {
                    showMessageModal('Validation Error', 'Please correct the errors in the form.', 'error');
                    return; // Stop submission if validation fails
                }

                showLoading(); // Show loading spinner
                await delay(500); // Simulate processing time

                const formData = new FormData(form);
                const newItem = {
                    id: generateUniqueId(),
                    type: formData.get('itemType'),
                    title: formData.get('title'),
                    description: formData.get('description'),
                    price: parseFloat(formData.get('price')),
                    imageUrl: formData.get('imageUrl') || `https://placehold.co/800x600/CCCCCC/000000?text=${formData.get('itemType')}+Image`, // Fallback
                };

                // Add type-specific data
                if (newItem.type === 'apartment') {
                    newItem.location = formData.get('location');
                    newItem.bedrooms = parseInt(formData.get('bedrooms'));
                    newItem.bathrooms = parseInt(formData.get('bathrooms'));
                    newItem.areaSqFt = parseInt(formData.get('areaSqFt'));
                } else if (newItem.type === 'car') {
                    newItem.make = formData.get('make');
                    newItem.model = formData.get('model');
                    newItem.year = parseInt(formData.get('year'));
                    newItem.mileage = parseInt(formData.get('mileage'));
                    newItem.fuelType = formData.get('fuelType');
                } else if (newItem.type === 'land') {
                    newItem.location = formData.get('landLocation'); // Note: 'landLocation' for land
                    newItem.areaAcres = parseFloat(formData.get('areaAcres'));
                    newItem.zoning = formData.get('zoning');
                }

                items.push(newItem); // Add new item to the array
                saveItems(); // Persist updated array to localStorage

                hideLoading(); // Hide loading spinner

                showMessageModal('Success!', 'New item added successfully!', 'success');
                form.reset(); // Clear the form fields
                renderTypeSpecificFields(); // Re-render dynamic fields to clear them
                navigateTo(newItem.type); // Navigate to the list of the newly added item's type
            });
        }

        /**
         * Main render function that decides which page to display based on `currentPage`.
         */
        function renderPage() {
            if (currentPage === 'home') {
                renderHomePage();
            } else if (currentPage === 'apartment' || currentPage === 'car' || currentPage === 'land') {
                renderItemList(currentPage);
            } else if (currentPage === 'itemDetail') {
                renderItemDetail(selectedItemId);
            } else if (currentPage === 'addItem') {
                renderAddItemForm();
            }
            // Ensure page content wrapper is correctly applied for most pages
            if (currentPage !== 'itemDetail' && currentPage !== 'addItem') {
                 appContentDiv.classList.add('page-content-wrapper');
            } else {
                 appContentDiv.classList.remove('page-content-wrapper'); // Detail and Add Item have their own wrapper styles
            }
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('current-year').textContent = new Date().getFullYear(); // Set current year in footer
            navigateTo('home'); // Load the home page first
        });
    </script>
</body>
</html>
